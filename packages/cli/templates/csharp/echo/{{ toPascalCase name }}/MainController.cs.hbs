using Microsoft.Teams.Api.Activities;
using Microsoft.Teams.Apps;
using Microsoft.Teams.Apps.Annotations;
using Microsoft.Teams.Apps.Activities;
using Microsoft.Teams.Apps.Plugins;

namespace {{ toPascalCase name }};

[TeamsController("main")]
public class MainController
{
    [Message]
    public async Task OnMessage([Context] MessageActivity activity, [Context] IContext.Client client)
    {
        await client.Send($"you said \"{activity.Text}\"");
    }

    [Activity]
    public async Task OnActivity(IContext<Activity> context, [Context] IContext.Next next)
    {
        context.Log.Info(context.AppId);
        await next();
    }

    [Microsoft.Teams.Apps.Events.Event("activity")]
    public void OnEvent(IPlugin plugin, Microsoft.Teams.Apps.Events.Event @event)
    {
        Console.WriteLine("!!HIT!!");
    }
}